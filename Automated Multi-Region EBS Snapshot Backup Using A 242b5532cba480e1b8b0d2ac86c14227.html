<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Automated Multi-Region EBS Snapshot Backup Using AWS Lambda</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="242b5532-cba4-80e1-b8b0-d2ac86c14227" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="aws-lambda-svgrepo-com.svg"/></div><h1 class="page-title"><strong>Automated Multi-Region EBS Snapshot Backup Using AWS Lambda</strong></h1><p class="page-description"></p></header><div class="page-body"><h1 id="242b5532-cba4-80cd-93a7-e4a5c9874950" class="">EBS Volume Backup Automation Project Documentation</h1><h2 id="242b5532-cba4-8089-9516-f9c7caba7a8e" class="">Project Overview</h2><p id="242b5532-cba4-8027-9abc-c1a035f596b4" class="">This document outlines the implementation of a serverless solution designed to automate the backup of all in-use EBS (Elastic Block Store) volumes across all AWS regions. The solution utilizes AWS Lambda, Boto3 (AWS SDK for Python), and Amazon EventBridge to orchestrate the snapshot creation process dynamically and efficiently.</p><p id="242b5532-cba4-8074-8d87-f5edcc9e7e16" class="">This documentation is structured to reflect the complete development, deployment, and learning process of the project and includes code walkthroughs, security considerations, and production-readiness justification.</p><hr id="242b5532-cba4-8047-ad04-ff0b16d39ece"/><h2 id="242b5532-cba4-8044-999b-dcbfe47ab743" class="">Key Features</h2><ul id="242b5532-cba4-80c6-b01c-fd69bed1d369" class="bulleted-list"><li style="list-style-type:disc"><strong>Cross-Region Coverage</strong>: Dynamically scans and processes all available AWS regions.</li></ul><ul id="242b5532-cba4-8067-8300-f9318e518599" class="bulleted-list"><li style="list-style-type:disc"><strong>EBS Volume Filtering</strong>: Filters for EBS volumes that are in the &#x27;in-use&#x27; state.</li></ul><ul id="242b5532-cba4-8044-9a7c-d75f0e2e28fc" class="bulleted-list"><li style="list-style-type:disc"><strong>Automated Snapshots</strong>: Creates snapshots of identified volumes automatically.</li></ul><ul id="242b5532-cba4-80c5-9419-dc68e17ddc20" class="bulleted-list"><li style="list-style-type:disc"><strong>Custom Metadata Tagging</strong>: Tags each snapshot with useful metadata.</li></ul><ul id="242b5532-cba4-80fd-b3c4-d538fd546823" class="bulleted-list"><li style="list-style-type:disc"><strong>EventBridge Scheduling</strong>: Can be configured to run daily, weekly, or at any interval.</li></ul><ul id="242b5532-cba4-804a-ab9f-f71d9061aac2" class="bulleted-list"><li style="list-style-type:disc"><strong>Secure IAM Permissions</strong>: Adheres to the principle of least privilege.</li></ul><hr id="242b5532-cba4-802d-a7f4-d75c1d3f74cf"/><h2 id="242b5532-cba4-809d-8abc-f76b6c76ec59" class="">Architecture Diagram</h2><figure id="242b5532-cba4-8085-82af-e933bbd16b9a" class="image"><a href="Architecture_Diagram.png"><img style="width:709.9768676757812px" src="./Architecture Diagram.png"/></a></figure><p id="242b5532-cba4-8045-b91f-ce0e2b936300" class=""><strong>Description</strong>:</p><ul id="242b5532-cba4-8035-b6ec-f7bedc3a5152" class="bulleted-list"><li style="list-style-type:disc">Amazon EventBridge triggers a Lambda function on a schedule.</li></ul><ul id="242b5532-cba4-8014-9040-efe281de2126" class="bulleted-list"><li style="list-style-type:disc">The Lambda function utilizes Boto3 to scan for and create snapshots.</li></ul><ul id="242b5532-cba4-80d5-8d78-db41027c7219" class="bulleted-list"><li style="list-style-type:disc">Snapshots are tagged and logged.</li></ul><hr id="242b5532-cba4-801e-a1f3-d50d7e3619d7"/><h2 id="242b5532-cba4-8086-b56b-fd4c8e54b8c3" class="">Workflow Summary</h2><ol type="1" id="242b5532-cba4-8095-9ba6-f6afc64d9efc" class="numbered-list" start="1"><li><strong>Scheduling</strong>: Amazon EventBridge invokes the Lambda function on a fixed schedule (e.g., daily at midnight).</li></ol><ol type="1" id="242b5532-cba4-80ee-85a6-f4749f4e9f6f" class="numbered-list" start="2"><li><strong>Region Discovery</strong>: Lambda identifies all active AWS regions using the <code>describe_regions</code> API.</li></ol><ol type="1" id="242b5532-cba4-8029-b9ed-c8abd4394a60" class="numbered-list" start="3"><li><strong>Volume Discovery</strong>: For each region, the Lambda queries for EBS volumes in the &#x27;in-use&#x27; state.</li></ol><ol type="1" id="242b5532-cba4-8099-97a6-d25f63f42c84" class="numbered-list" start="4"><li><strong>Snapshot Creation</strong>: For each in-use volume, the Lambda function creates a snapshot.</li></ol><ol type="1" id="242b5532-cba4-803a-b189-eba3cc989a5b" class="numbered-list" start="5"><li><strong>Tagging</strong>: Each snapshot is tagged with Region, Volume ID, and a descriptive label.</li></ol><hr id="242b5532-cba4-809a-8eb3-c86cb1aaafc0"/><h2 id="242b5532-cba4-80c1-ae25-c5820b45a10b" class="">IAM Policy: Security and Permissions</h2><p id="242b5532-cba4-801c-ad78-cd3d52cba7c5" class="">Initially, the Lambda was granted full EC2 access (<code>AmazonEC2FullAccess</code>), which violates the principle of least privilege. It was revised to the minimal set of permissions required:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="242b5532-cba4-802d-ac21-d25318be0902" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">[
  &quot;ec2:DescribeRegions&quot;,
  &quot;ec2:DescribeVolumes&quot;,
  &quot;ec2:CreateSnapshot&quot;,
  &quot;ec2:CreateTags&quot;
]
</code></pre><p id="242b5532-cba4-80f0-b8ff-d0917d1d16af" class=""><strong>Rationale</strong>: These permissions are the minimum needed to discover regions, list volumes, create snapshots, and tag them. Reducing permissions helps limit the blast radius in case of compromise.</p><hr id="242b5532-cba4-80a2-8db3-e97504738ea9"/><h2 id="242b5532-cba4-8045-892e-da35c3d49762" class="">Why This Solution Matters in Production</h2><p id="242b5532-cba4-805c-beee-c55f8716a9bf" class="">Data loss in production environments can result from:</p><ul id="242b5532-cba4-80ec-ac1e-f3a3825d8cc7" class="bulleted-list"><li style="list-style-type:disc">Hardware failure</li></ul><ul id="242b5532-cba4-806e-8180-f236f437862d" class="bulleted-list"><li style="list-style-type:disc">Human error</li></ul><ul id="242b5532-cba4-8071-8d0b-da82b4e9ad96" class="bulleted-list"><li style="list-style-type:disc">Cyber attacks</li></ul><p id="242b5532-cba4-80f0-8525-ecbe05d4a845" class="">This solution provides a resilient and scalable safeguard by ensuring all in-use volumes are regularly backed up. It ensures business continuity by maintaining current snapshots for disaster recovery scenarios.</p><hr id="242b5532-cba4-802f-ad7a-e091c50c1222"/><h2 id="242b5532-cba4-80f5-baeb-cf00128bb023" class="">Technology Stack</h2><ul id="242b5532-cba4-8016-bee6-ee0c246edfad" class="bulleted-list"><li style="list-style-type:disc"><strong>AWS Lambda</strong>: Executes snapshot logic serverlessly.</li></ul><ul id="242b5532-cba4-804d-a409-fd7d4185f70c" class="bulleted-list"><li style="list-style-type:disc"><strong>Boto3</strong>: AWS Python SDK used to interact with EC2 APIs.</li></ul><ul id="242b5532-cba4-8073-a48b-ffff218c4d45" class="bulleted-list"><li style="list-style-type:disc"><strong>Amazon EBS</strong>: Source of the data to be backed up.</li></ul><ul id="242b5532-cba4-80cc-955e-f52df7647b6b" class="bulleted-list"><li style="list-style-type:disc"><strong>Amazon EventBridge</strong>: Scheduler to trigger the Lambda function.</li></ul><ul id="242b5532-cba4-8060-8331-c4276ae9009b" class="bulleted-list"><li style="list-style-type:disc"><strong>AWS IAM</strong>: Secures the environment with proper access control.</li></ul><hr id="242b5532-cba4-805e-bf6e-fbf6123c1430"/><h2 id="242b5532-cba4-80b0-9c08-ff57845c07d5" class="">Lambda Code Walkthrough</h2><h3 id="242b5532-cba4-8047-80db-f0309ed007ee" class="">Full Lambda Function</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="242b5532-cba4-805a-b3a7-c5e1c3512f9a" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import boto3

def lambda_handler(event, context):
    regions = []
    # Get a list of all regions
    ec2_client = boto3.client(&#x27;ec2&#x27;)
    regions_response = ec2_client.describe_regions()
    for region in regions_response[&#x27;Regions&#x27;]:
        regions.append(region[&#x27;RegionName&#x27;])

    snapshots_created = []
    # Iterate through each region
    for region in regions:
        print(f&quot;Processing region: {region}&quot;)
        ec2 = boto3.client(&#x27;ec2&#x27;, region_name=region)
        # Get all volumes in &#x27;in-use&#x27; state
        volumes = ec2.describe_volumes(Filters=[{&#x27;Name&#x27;: &#x27;status&#x27;, &#x27;Values&#x27;: [&#x27;in-use&#x27;]}])[&#x27;Volumes&#x27;]
        for volume in volumes:
            volume_id = volume[&#x27;VolumeId&#x27;]
            print(f&quot;Creating snapshot for Volume: {volume_id}&quot;)
            # Create a snapshot
            try:
                snapshot = ec2.create_snapshot(
                    VolumeId=volume_id,
                    Description=f&quot;Snapshot of {volume_id} from region {region}&quot;
                )
                snapshots_created.append({
                    &quot;Region&quot;: region,
                    &quot;VolumeId&quot;: volume_id,
                    &quot;SnapshotId&quot;: snapshot[&#x27;SnapshotId&#x27;]
                })
                print(f&quot;Snapshot created: {snapshot[&#x27;SnapshotId&#x27;]}&quot;)
            except Exception as e:
                print(f&quot;Error creating snapshot for volume {volume_id} in region {region}: {str(e)}&quot;)

    return {
        &quot;statusCode&quot;: 200,
        &quot;body&quot;: f&quot;Snapshots created: {snapshots_created}&quot;
    }
</code></pre><h3 id="242b5532-cba4-8040-a7bb-ffb4cb7c2714" class="">Code Explained Step-by-Step</h3><ol type="1" id="242b5532-cba4-8014-bec7-d14df0429a4f" class="numbered-list" start="1"><li><strong>Initialization</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="242b5532-cba4-8065-9a2f-c93c5b08621f" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import boto3
regions = []
ec2_client = boto3.client(&#x27;ec2&#x27;)
</code></pre><p id="242b5532-cba4-80e9-b8ae-def04dcc6845" class="">The script imports Boto3 and initializes an EC2 client to start interacting with AWS EC2.</p></li></ol><ol type="1" id="242b5532-cba4-8016-8117-cabc6d6a4b6b" class="numbered-list" start="2"><li><strong>Get List of Regions</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="242b5532-cba4-8067-8f25-c5ff4367d52b" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">regions_response = ec2_client.describe_regions()
for region in regions_response[&#x27;Regions&#x27;]:
    regions.append(region[&#x27;RegionName&#x27;])
</code></pre><p id="242b5532-cba4-800e-8f9b-e5bc4111a135" class="">Uses <code>describe_regions</code> API to dynamically retrieve all AWS regions and stores their names.</p></li></ol><ol type="1" id="242b5532-cba4-80e7-8052-c65c8896933f" class="numbered-list" start="3"><li><strong>Loop Through Regions</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="242b5532-cba4-80d3-8984-d3d83eccae75" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">for region in regions:
    ec2 = boto3.client(&#x27;ec2&#x27;, region_name=region)
</code></pre><p id="242b5532-cba4-804b-8bc7-c39cbc04e3b8" class="">Iterates over each region and creates a regional EC2 client.</p></li></ol><ol type="1" id="242b5532-cba4-80ca-8e8f-eac3dcbb3f8c" class="numbered-list" start="4"><li><strong>Filter Volumes</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="242b5532-cba4-8072-9c18-ce87daa5135b" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">volumes = ec2.describe_volumes(Filters=[{&#x27;Name&#x27;: &#x27;status&#x27;, &#x27;Values&#x27;: [&#x27;in-use&#x27;]}])[&#x27;Volumes&#x27;]
</code></pre><p id="242b5532-cba4-80da-8527-c6d600847fab" class="">Fetches only those volumes that are actively attached to EC2 instances.</p></li></ol><ol type="1" id="242b5532-cba4-807b-b59e-fc6bedf66c06" class="numbered-list" start="5"><li><strong>Create Snapshots</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="242b5532-cba4-80ff-b538-ead3372da810" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">snapshot = ec2.create_snapshot(
    VolumeId=volume_id,
    Description=f&quot;Snapshot of {volume_id} from region {region}&quot;
)
</code></pre><p id="242b5532-cba4-8081-8c5c-e357a6483a1a" class="">Creates a snapshot for each in-use volume.</p></li></ol><ol type="1" id="242b5532-cba4-8083-a13b-e38634ef24c5" class="numbered-list" start="6"><li><strong>Append Snapshot Metadata</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="242b5532-cba4-8001-8656-e994a3b4fdef" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">snapshots_created.append({
    &quot;Region&quot;: region,
    &quot;VolumeId&quot;: volume_id,
    &quot;SnapshotId&quot;: snapshot[&#x27;SnapshotId&#x27;]
})
</code></pre><p id="242b5532-cba4-8099-9337-da2675740935" class="">Stores snapshot information for logging or reporting.</p></li></ol><ol type="1" id="242b5532-cba4-80d0-a641-ce7d3f82fecf" class="numbered-list" start="7"><li><strong>Return Summary</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="242b5532-cba4-8045-a86d-db1830c9e5e2" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">return {
    &quot;statusCode&quot;: 200,
    &quot;body&quot;: f&quot;Snapshots created: {snapshots_created}&quot;
}
</code></pre><p id="242b5532-cba4-8061-8114-edf714219e46" class="">Returns a 200 HTTP status with a summary of all snapshots created during execution.</p></li></ol><hr id="242b5532-cba4-8081-8bd5-e55ccebce502"/><h2 id="242b5532-cba4-8023-88c9-d242108fc7f1" class="">Further Improvements</h2><ul id="242b5532-cba4-806f-a1e8-d778aac70b22" class="bulleted-list"><li style="list-style-type:disc">Add tagging support (<code>CreateTags</code>) for categorization.</li></ul><ul id="242b5532-cba4-803a-816a-efbfb90421e7" class="bulleted-list"><li style="list-style-type:disc">Add error logging to CloudWatch for operational insights.</li></ul><ul id="242b5532-cba4-8055-98b2-ff31df0bd25a" class="bulleted-list"><li style="list-style-type:disc">Configure SNS notifications for snapshot success/failure alerts.</li></ul><ul id="242b5532-cba4-80a9-aeed-dd052728c850" class="bulleted-list"><li style="list-style-type:disc">Store snapshot logs in an S3 bucket for historical tracking.</li></ul><hr id="242b5532-cba4-80a9-a8f4-dd32a64b40a3"/><h2 id="242b5532-cba4-806a-b252-ccaf7e1a5dcc" class="">Conclusion</h2><p id="242b5532-cba4-808f-abdc-eb1c1816fabd" class="">This project demonstrates a practical and secure method for automating EBS volume backups across AWS. It utilizes best practices in IAM, serverless architecture, and dynamic AWS service discovery. The final solution is efficient, reliable, and production-ready, with room for continued enhancement.</p><hr id="242b5532-cba4-8046-b473-f8cdd37111a3"/></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>